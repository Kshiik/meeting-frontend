"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[597],{2597:(e,n,s)=>{s.r(n),s.d(n,{default:()=>D});var i=s(7876),l=s(4232),r=s(8207),t=s(8425),c=s(7578),d=s(8990),a=s(6626),x=s(7018),o=s(4868),h=s(8284),p=s(6120),A=s(656),j=s(4348),u=s(1951),m=s(7339),g=s(2639),v=s(8107),w=s(755),C=s(6347),f=s(946),y=s(9444),S=s(7224),F=s(968),E=s(4203),b=s(4274),k=s(8490),I=s(1640),O=s(8532),Z=s(7133),R=s(3316),B=s(8539),M=s(9099),T=s(4113);let D=e=>{var n;let{disableRoomElements:s=!1,idRoom:D}=e,N={day:"день",week:"неделю",month:"месяц",year:"год"},H=(0,r.A)("(max-width:1440px)"),_=(0,r.A)("(max-width:1024px)"),z=(0,r.A)("(max-width:600px)"),[q,W]=(0,l.useState)(0),[L,V]=(0,l.useState)([]),[G,X]=(0,l.useState)([]),[$,J]=(0,l.useState)(!0),[K,P]=(0,l.useState)(null),[Q,U]=(0,l.useState)(""),[Y,ee]=(0,l.useState)(D||""),[en,es]=(0,l.useState)(!1),[ei,el]=(0,l.useState)(1),[er,et]=(0,l.useState)({}),[ec,ed]=(0,l.useState)({}),[ea,ex]=(0,l.useState)(0),[eo,eh]=(0,l.useState)(!1),[ep,eA]=(0,l.useState)(!1),[ej,eu]=(0,l.useState)("create"),[em,eg]=(0,l.useState)(null),{user:ev,loading:ew,hasRole:eC}=(0,B.A)(),ef=(0,M.useRouter)(),{showNotification:ey}=(0,R.h)(),{confirm:eS,ConfirmComponent:eF}=(0,T.G)(),[eE,eb]=(0,l.useState)(1),[ek,eI]=(0,l.useState)([]);(0,l.useEffect)(()=>{!ew&&eC("ROLE_MODERATOR")&&!s&&ef.push("/eventsadmin")},[ev,ew,eC,ef]);let eO=e=>{et(n=>({...n,[e]:!n[e]}))},eZ=e=>n=>{ed(s=>({...s,[e]:n.currentTarget}))},eR=e=>()=>{ed(n=>({...n,[e]:null}))},eB=()=>{eu("create"),eg(null),eA(!0)},eM=e=>{eu("edit"),eg(e),eA(!0)},eT=async e=>{if(await eS({message:"Вы уверены, что хотите удалить это мероприятие?",confirmText:"Удалить",cancelText:"Отмена"}))try{await (0,I.SX)(e.id),ed({}),eD(),ey("Мероприятие успешно удалено","success")}catch(e){ey("Не удалось удалить мероприятие","error")}};(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,O.g)();X(e.data)}catch(e){ey("Не удалось загрузить комнаты","error")}})()},[ey]);let eD=async()=>{try{J(!0),P(null);let e=await (0,I.y$)({roomId:""===Y?void 0:Y,name:Q||void 0,type:0===q?"организатор":"участник",isArchived:"false",descOrder:en});V(e),ex(e.length),eb(Math.ceil(e.length/10)),el(1),eI(e.slice(0,10))}catch(e){ey("Не удалось загрузить мероприятия","error"),P("Не удалось загрузить мероприятия")}finally{J(!1)}};return((0,l.useEffect)(()=>{eD()},[q,Q,Y,en]),ew||eC("ROLE_MODERATOR"))?null:(0,i.jsx)(t.A,{theme:k.A,children:(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:_?"94vh":"92vh"},children:[(0,i.jsxs)(c.A,{children:[(0,i.jsxs)(c.A,{sx:{display:"flex",alignItems:H?"stetch":"center",justifyContent:"space-between",marginBottom:"1em",flexDirection:H?"column":"row",gap:1},children:[(0,i.jsxs)(d.A,{value:q,onChange:(e,n)=>{ex(0),W(n)},"aria-label":"event tabs",sx:{"& .MuiTabs-indicator":{display:"none"},width:"100%",display:"flex",alignItems:z?"flex-end":"center",flexDirection:z?"column":"row"},children:[(0,i.jsx)(a.A,{label:(0,i.jsxs)(c.A,{sx:{display:"flex",gap:1},children:[(0,i.jsx)(x.A,{variant:"h5",sx:{color:0===q?"#000":"#A3A3A3"},children:"Мои мероприятия"}),0===q&&(0,i.jsx)(x.A,{sx:{fontSize:"14px",color:"#A3A3A3"},children:ea})]}),sx:{opacity:0===q?1:.5}}),(0,i.jsx)(a.A,{label:(0,i.jsxs)(c.A,{sx:{display:"flex",gap:1},children:[(0,i.jsx)(x.A,{variant:"h5",sx:{color:1===q?"#000":"#A3A3A3"},children:"Участвую"}),1===q&&(0,i.jsx)(x.A,{sx:{fontSize:"14px",color:"#A3A3A3"},children:ea})]}),sx:{opacity:1===q?1:.5}})]}),(0,i.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:2,flexDirection:z?"column":"row"},children:[0===q&&(0,i.jsx)(o.A,{variant:"outlined",color:"secondary",onClick:()=>eB(),sx:{width:z?"100%":"auto"},children:(0,i.jsx)("svg",{height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#858585",children:(0,i.jsx)("path",{d:"M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z"})})}),(0,i.jsxs)(c.A,{sx:{display:"flex",gap:2,width:"100%",flexDirection:z?"column":"row"},children:[(0,i.jsx)(h.A,{variant:"outlined",placeholder:"Название мероприятия",value:Q,onChange:e=>U(e.target.value),sx:{width:H?"100%":"230px"}}),!s&&(0,i.jsxs)(p.A,{value:Y,onChange:e=>ee(e.target.value),displayEmpty:!0,sx:{width:H?"100%":"230px"},children:[(0,i.jsx)(A.A,{value:"",children:"Все комнаты"}),G.map(e=>(0,i.jsx)(A.A,{value:e.id,children:e.name},e.id))]})]})]})]}),0===q&&(0,i.jsx)(j.A,{component:u.A,children:(0,i.jsxs)(m.A,{children:[(0,i.jsx)(g.A,{color:"secondary",children:(0,i.jsxs)(v.A,{children:[(0,i.jsx)(w.A,{}),(0,i.jsx)(w.A,{children:"Наименование"}),(0,i.jsx)(w.A,{sx:{whiteSpace:"nowrap"},children:H?"Перег. комната":"Переговорная комната"}),(0,i.jsx)(w.A,{children:"Дата"}),(0,i.jsx)(w.A,{children:H?"Начало":"Время начала"}),(0,i.jsx)(w.A,{children:H?"Конец":"Время оканчания"}),(0,i.jsx)(w.A,{children:"Повторы"}),(0,i.jsx)(w.A,{align:"center",children:(0,i.jsx)("svg",{width:"16",height:"10",viewBox:"0 0 16 4",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M2 4C1.45 4 0.979167 3.80417 0.5875 3.4125C0.195833 3.02083 0 2.55 0 2C0 1.45 0.195833 0.979167 0.5875 0.5875C0.979167 0.195833 1.45 0 2 0C2.55 0 3.02083 0.195833 3.4125 0.5875C3.80417 0.979167 4 1.45 4 2C4 2.55 3.80417 3.02083 3.4125 3.4125C3.02083 3.80417 2.55 4 2 4ZM8 4C7.45 4 6.97917 3.80417 6.5875 3.4125C6.19583 3.02083 6 2.55 6 2C6 1.45 6.19583 0.979167 6.5875 0.5875C6.97917 0.195833 7.45 0 8 0C8.55 0 9.02083 0.195833 9.4125 0.5875C9.80417 0.979167 10 1.45 10 2C10 2.55 9.80417 3.02083 9.4125 3.4125C9.02083 3.80417 8.55 4 8 4ZM14 4C13.45 4 12.9792 3.80417 12.5875 3.4125C12.1958 3.02083 12 2.55 12 2C12 1.45 12.1958 0.979167 12.5875 0.5875C12.9792 0.195833 13.45 0 14 0C14.55 0 15.0208 0.195833 15.4125 0.5875C15.8042 0.979167 16 1.45 16 2C16 2.55 15.8042 3.02083 15.4125 3.4125C15.0208 3.80417 14.55 4 14 4Z",fill:"#858585"})})})]})}),(0,i.jsx)(C.A,{children:$?(0,i.jsx)(v.A,{children:(0,i.jsx)(w.A,{colSpan:8,children:(0,i.jsx)(x.A,{align:"center",children:"Загрузка..."})})}):K?(0,i.jsx)(v.A,{children:(0,i.jsx)(w.A,{colSpan:8,children:(0,i.jsx)(x.A,{align:"center",color:"error",children:K})})}):ek.map((e,n)=>(0,i.jsxs)(l.Fragment,{children:[(0,i.jsxs)(v.A,{sx:{"&:nth-of-type(odd)":{backgroundColor:"#FFFFFF"},"&:nth-of-type(4n-3)":{backgroundColor:"#F4F4F4"}},children:[(0,i.jsx)(w.A,{children:(0,i.jsx)(f.A,{onClick:()=>eO(n),size:"small",sx:{padding:"0"},children:er[n]?(0,i.jsx)(E.A,{}):(0,i.jsx)(b.A,{})})}),(0,i.jsx)(w.A,{sx:{maxWidth:_?"165px":"300px",overflow:er[n]?"visible":"hidden",textOverflow:er[n]?"unset":"ellipsis",whiteSpace:er[n]?"normal":"nowrap"},children:e.name}),(0,i.jsx)(w.A,{sx:{maxWidth:"165px",overflow:er[n]?"visible":"hidden",textOverflow:er[n]?"unset":"ellipsis",whiteSpace:er[n]?"normal":"nowrap"},children:e.meetingRoomName}),(0,i.jsx)(w.A,{sx:{whiteSpace:"nowrap"},children:e.date}),(0,i.jsx)(w.A,{children:e.timeStart}),(0,i.jsx)(w.A,{children:e.timeEnd}),(0,i.jsx)(w.A,{sx:{whiteSpace:"nowrap"},children:e.recurrenceInterval?"Каждый(ую) ".concat(e.recurrenceInterval," ").concat(N[e.recurrenceTypeValue],", до ").concat(e.recurrenceEnd):"Нет повторов"}),(0,i.jsxs)(w.A,{align:"center",children:[(0,i.jsx)(f.A,{onClick:eZ(n),sx:{padding:"0"},children:(0,i.jsx)("svg",{height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#858585",children:(0,i.jsx)("path",{d:"M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"})})}),(0,i.jsxs)(y.A,{anchorEl:ec[n],open:!!ec[n],onClose:eR(n),sx:{border:"1px solid #858585"},children:[(0,i.jsxs)(A.A,{sx:{gap:1},onClick:()=>eM(e),children:[(0,i.jsx)("svg",{height:"20px",viewBox:"0 -960 960 960",width:"20px",children:(0,i.jsx)("path",{d:"M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"})}),e.recurrenceInterval?"Изменить серию":"Изменить мероприятие"]}),(0,i.jsxs)(A.A,{sx:{gap:1},onClick:()=>eT(e),children:[(0,i.jsx)("svg",{height:"20px",viewBox:"0 -960 960 960",width:"20px",children:(0,i.jsx)("path",{d:"m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"})}),e.recurrenceInterval?"Удалить серию":"Удалить мероприятие"]})]})]})]}),(0,i.jsxs)(v.A,{children:[(0,i.jsx)(w.A,{sx:{padding:0}}),(0,i.jsx)(w.A,{colSpan:7,sx:{padding:0},children:(0,i.jsx)(S.A,{in:er[n],timeout:"auto",unmountOnExit:!0,children:(0,i.jsxs)(c.A,{sx:{margin:2},children:[(0,i.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,i.jsx)(x.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Описание"}),(0,i.jsx)(x.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.description})]}),(0,i.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,i.jsx)(x.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Участники"}),e.employees.length>0?e.employees.map(e=>(0,i.jsx)(x.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.fullName},e.id)):(0,i.jsx)(x.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:"Не указано"})]})]})})})]})]},"".concat(e.id,"-").concat(e.date)))})]})}),1===q&&(0,i.jsx)(j.A,{component:u.A,children:(0,i.jsxs)(m.A,{children:[(0,i.jsx)(g.A,{color:"secondary",children:(0,i.jsxs)(v.A,{children:[(0,i.jsx)(w.A,{}),(0,i.jsx)(w.A,{children:"Наименование"}),(0,i.jsx)(w.A,{children:"Автор"}),(0,i.jsx)(w.A,{sx:{whiteSpace:"nowrap"},children:H?"Перег. комната":"Переговорная комната"}),(0,i.jsx)(w.A,{children:"Дата"}),(0,i.jsx)(w.A,{children:H?"Начало":"Время начала"}),(0,i.jsx)(w.A,{children:H?"Конец":"Время оканчания"}),(0,i.jsx)(w.A,{children:"Повторы"})]})}),(0,i.jsx)(C.A,{children:$?(0,i.jsx)(v.A,{children:(0,i.jsx)(w.A,{colSpan:8,children:(0,i.jsx)(x.A,{align:"center",children:"Загрузка..."})})}):K?(0,i.jsx)(v.A,{children:(0,i.jsx)(w.A,{colSpan:8,children:(0,i.jsx)(x.A,{align:"center",color:"error",children:K})})}):ek.map((e,n)=>(0,i.jsxs)(l.Fragment,{children:[(0,i.jsxs)(v.A,{sx:{"&:nth-of-type(odd)":{backgroundColor:"#FFFFFF"},"&:nth-of-type(4n-3)":{backgroundColor:"#F4F4F4"}},children:[(0,i.jsx)(w.A,{children:(0,i.jsx)(f.A,{onClick:()=>eO(n),size:"small",sx:{padding:"0"},children:er[n]?(0,i.jsx)(E.A,{}):(0,i.jsx)(b.A,{})})}),(0,i.jsx)(w.A,{sx:{maxWidth:_?"165px":"300px",overflow:er[n]?"visible":"hidden",textOverflow:er[n]?"unset":"ellipsis",whiteSpace:er[n]?"normal":"nowrap"},children:e.name}),(0,i.jsx)(w.A,{children:e.author.fullName}),(0,i.jsx)(w.A,{sx:{maxWidth:"165px",overflow:er[n]?"visible":"hidden",textOverflow:er[n]?"unset":"ellipsis",whiteSpace:er[n]?"normal":"nowrap"},children:e.meetingRoomName}),(0,i.jsx)(w.A,{sx:{whiteSpace:"nowrap"},children:e.date}),(0,i.jsx)(w.A,{children:e.timeStart}),(0,i.jsx)(w.A,{children:e.timeEnd}),(0,i.jsx)(w.A,{sx:{whiteSpace:"nowrap"},children:e.recurrenceInterval?"Каждый(ую) ".concat(e.recurrenceInterval," ").concat(N[e.recurrenceTypeValue],", до ").concat(e.recurrenceEnd):"Нет повторов"})]}),(0,i.jsxs)(v.A,{children:[(0,i.jsx)(w.A,{sx:{padding:0}}),(0,i.jsx)(w.A,{colSpan:7,sx:{padding:0},children:(0,i.jsx)(S.A,{in:er[n],timeout:"auto",unmountOnExit:!0,children:(0,i.jsxs)(c.A,{sx:{margin:2},children:[(0,i.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,i.jsx)(x.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Описание"}),(0,i.jsx)(x.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.description})]}),(0,i.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,i.jsx)(x.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Участники"}),e.employees.length>0?e.employees.map(e=>(0,i.jsx)(x.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.fullName},e.id)):(0,i.jsx)(x.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:"Не указано"})]})]})})})]})]},"".concat(e.id,"-").concat(e.date)))})]})})]}),eE>1&&(0,i.jsx)(c.A,{sx:{mt:4,display:"flex",justifyContent:"start"},children:(0,i.jsx)(F.A,{count:eE,page:ei,onChange:(e,n)=>{el(n);let s=(n-1)*10;eI(L.slice(s,s+10))},color:"primary",size:"medium"})}),(0,i.jsx)(Z.A,{open:ep,onClose:()=>{eA(!1),ed({}),eg(null),eu("create"),eD()},mode:ej,event:"create"===ej?null:{name:em.name,description:em.description,authorId:em.author.id,meetingRoomId:em.meetingRoomId,employeeIds:em.employees.map(e=>e.id),date:null!==(n=em.originalDate)&&void 0!==n?n:em.date,timeStart:em.timeStart,timeEnd:em.timeEnd},idEvent:"create"===ej?null:em.id}),(0,i.jsx)(eF,{})]})})}}}]);