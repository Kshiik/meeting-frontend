"use strict";exports.id=704,exports.ids=[704],exports.modules={28704:(e,n,s)=>{s.a(e,async(e,i)=>{try{s.r(n),s.d(n,{default:()=>z});var l=s(8732),r=s(82015),t=s.n(r),d=s(28062),a=s(74257),c=s(87194),x=s(82989),o=s(17527),h=s(21087),p=s(43169),A=s(2571),j=s(84329),u=s(67173),m=s(26495),g=s(36443),v=s(93971),w=s(94835),C=s(58993),f=s(35275),y=s(28983),S=s(25867),F=s(9351),E=s(95223),b=s(37941),k=s(60428),I=s(82603),O=s(44483),Z=s(10933),R=s(557),$=s(47286),B=s(35819),M=s(63212),T=s(44233),D=s(80675),H=e([$,B,M,D,x,o,h,p,A,j,u,m,g,v,w,C,f,y,S,F,E,b]);[$,B,M,D,x,o,h,p,A,j,u,m,g,v,w,C,f,y,S,F,E,b]=H.then?(await H)():H;let z=({disableRoomElements:e=!1,idRoom:n})=>{let s={day:"день",week:"неделю",month:"месяц",year:"год"},i=(0,d.A)("(max-width:1440px)"),H=(0,d.A)("(max-width:1024px)"),z=(0,d.A)("(max-width:600px)"),[N,q]=(0,r.useState)(0),[W,L]=(0,r.useState)([]),[V,_]=(0,r.useState)([]),[G,X]=(0,r.useState)(!0),[J,K]=(0,r.useState)(null),[P,Q]=(0,r.useState)(""),[U,Y]=(0,r.useState)(n||""),[ee,en]=(0,r.useState)(!1),[es,ei]=(0,r.useState)(1),[el,er]=(0,r.useState)({}),[et,ed]=(0,r.useState)({}),[ea,ec]=(0,r.useState)(0),[ex,eo]=(0,r.useState)(!1),[eh,ep]=(0,r.useState)(!1),[eA,ej]=(0,r.useState)("create"),[eu,em]=(0,r.useState)(null),{user:eg,loading:ev,hasRole:ew}=(0,M.A)(),eC=(0,T.useRouter)(),{showNotification:ef}=(0,B.h)(),{confirm:ey,ConfirmComponent:eS}=(0,D.G)(),[eF,eE]=(0,r.useState)(1),[eb,ek]=(0,r.useState)([]);(0,r.useEffect)(()=>{!ev&&ew("ROLE_MODERATOR")&&!e&&eC.push("/eventsadmin")},[eg,ev,ew,eC]);let eI=e=>{er(n=>({...n,[e]:!n[e]}))},eO=e=>n=>{ed(s=>({...s,[e]:n.currentTarget}))},eZ=e=>()=>{ed(n=>({...n,[e]:null}))},eR=()=>{ej("create"),em(null),ep(!0)},e$=e=>{ej("edit"),em(e),ep(!0)},eB=async e=>{if(await ey({message:"Вы уверены, что хотите удалить это мероприятие?",confirmText:"Удалить",cancelText:"Отмена"}))try{await (0,Z.SX)(e.id),ed({}),eM(),ef("Мероприятие успешно удалено","success")}catch(e){ef("Не удалось удалить мероприятие","error")}};(0,r.useEffect)(()=>{(async()=>{try{let e=await (0,R.g)();_(e.data)}catch(e){ef("Не удалось загрузить комнаты","error")}})()},[ef]);let eM=async()=>{try{X(!0),K(null);let e=await (0,Z.y$)({roomId:""===U?void 0:U,name:P||void 0,type:0===N?"организатор":"участник",isArchived:"false",descOrder:ee});L(e),ec(e.length),eE(Math.ceil(e.length/10)),ei(1),ek(e.slice(0,10))}catch(e){ef("Не удалось загрузить мероприятия","error"),K("Не удалось загрузить мероприятия")}finally{X(!1)}};return((0,r.useEffect)(()=>{eM()},[N,P,U,ee]),ev||ew("ROLE_MODERATOR"))?null:(0,l.jsx)(a.A,{theme:O.A,children:(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:H?"94vh":"92vh"},children:[(0,l.jsxs)(c.A,{children:[(0,l.jsxs)(c.A,{sx:{display:"flex",alignItems:i?"stetch":"center",justifyContent:"space-between",marginBottom:"1em",flexDirection:i?"column":"row",gap:1},children:[(0,l.jsxs)(x.A,{value:N,onChange:(e,n)=>{ec(0),q(n)},"aria-label":"event tabs",sx:{"& .MuiTabs-indicator":{display:"none"},width:"100%",display:"flex",alignItems:z?"flex-end":"center",flexDirection:z?"column":"row"},children:[(0,l.jsx)(o.A,{label:(0,l.jsxs)(c.A,{sx:{display:"flex",gap:1},children:[(0,l.jsx)(h.A,{variant:"h5",sx:{color:0===N?"#000":"#A3A3A3"},children:"Мои мероприятия"}),0===N&&(0,l.jsx)(h.A,{sx:{fontSize:"14px",color:"#A3A3A3"},children:ea})]}),sx:{opacity:0===N?1:.5}}),(0,l.jsx)(o.A,{label:(0,l.jsxs)(c.A,{sx:{display:"flex",gap:1},children:[(0,l.jsx)(h.A,{variant:"h5",sx:{color:1===N?"#000":"#A3A3A3"},children:"Участвую"}),1===N&&(0,l.jsx)(h.A,{sx:{fontSize:"14px",color:"#A3A3A3"},children:ea})]}),sx:{opacity:1===N?1:.5}})]}),(0,l.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:2,flexDirection:z?"column":"row"},children:[0===N&&(0,l.jsx)(p.A,{variant:"outlined",color:"secondary",onClick:()=>eR(),sx:{width:z?"100%":"auto"},children:(0,l.jsx)("svg",{height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#858585",children:(0,l.jsx)("path",{d:"M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z"})})}),(0,l.jsxs)(c.A,{sx:{display:"flex",gap:2,width:"100%",flexDirection:z?"column":"row"},children:[(0,l.jsx)(A.A,{variant:"outlined",placeholder:"Название мероприятия",value:P,onChange:e=>Q(e.target.value),sx:{width:i?"100%":"230px"}}),!e&&(0,l.jsxs)(j.A,{value:U,onChange:e=>Y(e.target.value),displayEmpty:!0,sx:{width:i?"100%":"230px"},children:[(0,l.jsx)(u.A,{value:"",children:"Все комнаты"}),V.map(e=>(0,l.jsx)(u.A,{value:e.id,children:e.name},e.id))]})]})]})]}),0===N&&(0,l.jsx)(m.A,{component:g.A,children:(0,l.jsxs)(v.A,{children:[(0,l.jsx)(w.A,{color:"secondary",children:(0,l.jsxs)(C.A,{children:[(0,l.jsx)(f.A,{}),(0,l.jsx)(f.A,{children:"Наименование"}),(0,l.jsx)(f.A,{sx:{whiteSpace:"nowrap"},children:i?"Перег. комната":"Переговорная комната"}),(0,l.jsx)(f.A,{children:"Дата"}),(0,l.jsx)(f.A,{children:i?"Начало":"Время начала"}),(0,l.jsx)(f.A,{children:i?"Конец":"Время оканчания"}),(0,l.jsx)(f.A,{children:"Повторы"}),(0,l.jsx)(f.A,{align:"center",children:(0,l.jsx)("svg",{width:"16",height:"10",viewBox:"0 0 16 4",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M2 4C1.45 4 0.979167 3.80417 0.5875 3.4125C0.195833 3.02083 0 2.55 0 2C0 1.45 0.195833 0.979167 0.5875 0.5875C0.979167 0.195833 1.45 0 2 0C2.55 0 3.02083 0.195833 3.4125 0.5875C3.80417 0.979167 4 1.45 4 2C4 2.55 3.80417 3.02083 3.4125 3.4125C3.02083 3.80417 2.55 4 2 4ZM8 4C7.45 4 6.97917 3.80417 6.5875 3.4125C6.19583 3.02083 6 2.55 6 2C6 1.45 6.19583 0.979167 6.5875 0.5875C6.97917 0.195833 7.45 0 8 0C8.55 0 9.02083 0.195833 9.4125 0.5875C9.80417 0.979167 10 1.45 10 2C10 2.55 9.80417 3.02083 9.4125 3.4125C9.02083 3.80417 8.55 4 8 4ZM14 4C13.45 4 12.9792 3.80417 12.5875 3.4125C12.1958 3.02083 12 2.55 12 2C12 1.45 12.1958 0.979167 12.5875 0.5875C12.9792 0.195833 13.45 0 14 0C14.55 0 15.0208 0.195833 15.4125 0.5875C15.8042 0.979167 16 1.45 16 2C16 2.55 15.8042 3.02083 15.4125 3.4125C15.0208 3.80417 14.55 4 14 4Z",fill:"#858585"})})})]})}),(0,l.jsx)(y.A,{children:G?(0,l.jsx)(C.A,{children:(0,l.jsx)(f.A,{colSpan:8,children:(0,l.jsx)(h.A,{align:"center",children:"Загрузка..."})})}):J?(0,l.jsx)(C.A,{children:(0,l.jsx)(f.A,{colSpan:8,children:(0,l.jsx)(h.A,{align:"center",color:"error",children:J})})}):eb.map((e,n)=>(0,l.jsxs)(t().Fragment,{children:[(0,l.jsxs)(C.A,{sx:{"&:nth-of-type(odd)":{backgroundColor:"#FFFFFF"},"&:nth-of-type(4n-3)":{backgroundColor:"#F4F4F4"}},children:[(0,l.jsx)(f.A,{children:(0,l.jsx)(S.A,{onClick:()=>eI(n),size:"small",sx:{padding:"0"},children:el[n]?(0,l.jsx)(k.A,{}):(0,l.jsx)(I.A,{})})}),(0,l.jsx)(f.A,{sx:{maxWidth:H?"165px":"300px",overflow:el[n]?"visible":"hidden",textOverflow:el[n]?"unset":"ellipsis",whiteSpace:el[n]?"normal":"nowrap"},children:e.name}),(0,l.jsx)(f.A,{sx:{maxWidth:"165px",overflow:el[n]?"visible":"hidden",textOverflow:el[n]?"unset":"ellipsis",whiteSpace:el[n]?"normal":"nowrap"},children:e.meetingRoomName}),(0,l.jsx)(f.A,{sx:{whiteSpace:"nowrap"},children:e.date}),(0,l.jsx)(f.A,{children:e.timeStart}),(0,l.jsx)(f.A,{children:e.timeEnd}),(0,l.jsx)(f.A,{sx:{whiteSpace:"nowrap"},children:e.recurrenceInterval?`Каждый(ую) ${e.recurrenceInterval} ${s[e.recurrenceTypeValue]}, до ${e.recurrenceEnd}`:"Нет повторов"}),(0,l.jsxs)(f.A,{align:"center",children:[(0,l.jsx)(S.A,{onClick:eO(n),sx:{padding:"0"},children:(0,l.jsx)("svg",{height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#858585",children:(0,l.jsx)("path",{d:"M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"})})}),(0,l.jsxs)(F.A,{anchorEl:et[n],open:!!et[n],onClose:eZ(n),sx:{border:"1px solid #858585"},children:[(0,l.jsxs)(u.A,{sx:{gap:1},onClick:()=>e$(e),children:[(0,l.jsx)("svg",{height:"20px",viewBox:"0 -960 960 960",width:"20px",children:(0,l.jsx)("path",{d:"M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"})}),e.recurrenceInterval?"Изменить серию":"Изменить мероприятие"]}),(0,l.jsxs)(u.A,{sx:{gap:1},onClick:()=>eB(e),children:[(0,l.jsx)("svg",{height:"20px",viewBox:"0 -960 960 960",width:"20px",children:(0,l.jsx)("path",{d:"m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"})}),e.recurrenceInterval?"Удалить серию":"Удалить мероприятие"]})]})]})]}),(0,l.jsxs)(C.A,{children:[(0,l.jsx)(f.A,{sx:{padding:0}}),(0,l.jsx)(f.A,{colSpan:7,sx:{padding:0},children:(0,l.jsx)(E.A,{in:el[n],timeout:"auto",unmountOnExit:!0,children:(0,l.jsxs)(c.A,{sx:{margin:2},children:[(0,l.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,l.jsx)(h.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Описание"}),(0,l.jsx)(h.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.description})]}),(0,l.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,l.jsx)(h.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Участники"}),e.employees.length>0?e.employees.map(e=>(0,l.jsx)(h.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.fullName},e.id)):(0,l.jsx)(h.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:"Не указано"})]})]})})})]})]},`${e.id}-${e.date}`))})]})}),1===N&&(0,l.jsx)(m.A,{component:g.A,children:(0,l.jsxs)(v.A,{children:[(0,l.jsx)(w.A,{color:"secondary",children:(0,l.jsxs)(C.A,{children:[(0,l.jsx)(f.A,{}),(0,l.jsx)(f.A,{children:"Наименование"}),(0,l.jsx)(f.A,{children:"Автор"}),(0,l.jsx)(f.A,{sx:{whiteSpace:"nowrap"},children:i?"Перег. комната":"Переговорная комната"}),(0,l.jsx)(f.A,{children:"Дата"}),(0,l.jsx)(f.A,{children:i?"Начало":"Время начала"}),(0,l.jsx)(f.A,{children:i?"Конец":"Время оканчания"}),(0,l.jsx)(f.A,{children:"Повторы"})]})}),(0,l.jsx)(y.A,{children:G?(0,l.jsx)(C.A,{children:(0,l.jsx)(f.A,{colSpan:8,children:(0,l.jsx)(h.A,{align:"center",children:"Загрузка..."})})}):J?(0,l.jsx)(C.A,{children:(0,l.jsx)(f.A,{colSpan:8,children:(0,l.jsx)(h.A,{align:"center",color:"error",children:J})})}):eb.map((e,n)=>(0,l.jsxs)(t().Fragment,{children:[(0,l.jsxs)(C.A,{sx:{"&:nth-of-type(odd)":{backgroundColor:"#FFFFFF"},"&:nth-of-type(4n-3)":{backgroundColor:"#F4F4F4"}},children:[(0,l.jsx)(f.A,{children:(0,l.jsx)(S.A,{onClick:()=>eI(n),size:"small",sx:{padding:"0"},children:el[n]?(0,l.jsx)(k.A,{}):(0,l.jsx)(I.A,{})})}),(0,l.jsx)(f.A,{sx:{maxWidth:H?"165px":"300px",overflow:el[n]?"visible":"hidden",textOverflow:el[n]?"unset":"ellipsis",whiteSpace:el[n]?"normal":"nowrap"},children:e.name}),(0,l.jsx)(f.A,{children:e.author.fullName}),(0,l.jsx)(f.A,{sx:{maxWidth:"165px",overflow:el[n]?"visible":"hidden",textOverflow:el[n]?"unset":"ellipsis",whiteSpace:el[n]?"normal":"nowrap"},children:e.meetingRoomName}),(0,l.jsx)(f.A,{sx:{whiteSpace:"nowrap"},children:e.date}),(0,l.jsx)(f.A,{children:e.timeStart}),(0,l.jsx)(f.A,{children:e.timeEnd}),(0,l.jsx)(f.A,{sx:{whiteSpace:"nowrap"},children:e.recurrenceInterval?`Каждый(ую) ${e.recurrenceInterval} ${s[e.recurrenceTypeValue]}, до ${e.recurrenceEnd}`:"Нет повторов"})]}),(0,l.jsxs)(C.A,{children:[(0,l.jsx)(f.A,{sx:{padding:0}}),(0,l.jsx)(f.A,{colSpan:7,sx:{padding:0},children:(0,l.jsx)(E.A,{in:el[n],timeout:"auto",unmountOnExit:!0,children:(0,l.jsxs)(c.A,{sx:{margin:2},children:[(0,l.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,l.jsx)(h.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Описание"}),(0,l.jsx)(h.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.description})]}),(0,l.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,l.jsx)(h.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Участники"}),e.employees.length>0?e.employees.map(e=>(0,l.jsx)(h.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.fullName},e.id)):(0,l.jsx)(h.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:"Не указано"})]})]})})})]})]},`${e.id}-${e.date}`))})]})})]}),eF>1&&(0,l.jsx)(c.A,{sx:{mt:4,display:"flex",justifyContent:"start"},children:(0,l.jsx)(b.A,{count:eF,page:es,onChange:(e,n)=>{ei(n);let s=(n-1)*10;ek(W.slice(s,s+10))},color:"primary",size:"medium"})}),(0,l.jsx)($.A,{open:eh,onClose:()=>{ep(!1),ed({}),em(null),ej("create"),eM()},mode:eA,event:"create"===eA?null:{name:eu.name,description:eu.description,authorId:eu.author.id,meetingRoomId:eu.meetingRoomId,employeeIds:eu.employees.map(e=>e.id),date:eu.originalDate??eu.date,timeStart:eu.timeStart,timeEnd:eu.timeEnd},idEvent:"create"===eA?null:eu.id}),(0,l.jsx)(eS,{})]})})};i()}catch(e){i(e)}})}};