"use strict";exports.id=805,exports.ids=[805],exports.modules={51805:(e,n,s)=>{s.a(e,async(e,r)=>{try{s.r(n),s.d(n,{default:()=>H});var i=s(8732),l=s(82015),t=s.n(l),a=s(28062),d=s(74257),c=s(87194),x=s(21087),o=s(43169),h=s(2571),p=s(84329),j=s(67173),u=s(26495),A=s(36443),m=s(93971),g=s(94835),v=s(58993),w=s(35275),C=s(25867),f=s(28983),y=s(9351),S=s(95223),E=s(37941),F=s(82603),I=s(60428),k=s(44483),b=s(63212),Z=s(44233),R=s(557),M=s(10933),O=s(47286),T=s(80675),B=s(35819),D=e([b,O,T,B,x,o,h,p,j,u,A,m,g,v,w,C,f,y,S,E]);[b,O,T,B,x,o,h,p,j,u,A,m,g,v,w,C,f,y,S,E]=D.then?(await D)():D;let H=({disableRoomElements:e=!1,idRoom:n,showAuthorColumn:s=!1})=>{let r={day:"день",week:"неделю",month:"месяц",year:"год"},D=(0,a.A)("(max-width:1440px)"),H=(0,a.A)("(max-width:1024px)"),$=(0,a.A)("(max-width:600px)"),{user:z,loading:q,hasRole:L}=(0,b.A)(),N=(0,Z.useRouter)(),{showNotification:V}=(0,B.h)(),{confirm:W,ConfirmComponent:_}=(0,T.G)();(0,l.useEffect)(()=>{q||z&&L("ROLE_MODERATOR")||N.push("/events")},[z,q,L,N]);let[G,X]=(0,l.useState)([]),[J,K]=(0,l.useState)([]),[P,Q]=(0,l.useState)(0),[U,Y]=(0,l.useState)(!0),[ee,en]=(0,l.useState)(null),[es,er]=(0,l.useState)({}),[ei,el]=(0,l.useState)({}),[et,ea]=(0,l.useState)(!1),[ed,ec]=(0,l.useState)("create"),[ex,eo]=(0,l.useState)(null),[eh,ep]=(0,l.useState)(""),[ej,eu]=(0,l.useState)(n||""),[eA,em]=(0,l.useState)(!1),[eg,ev]=(0,l.useState)(1),[ew,eC]=(0,l.useState)(1),[ef,ey]=(0,l.useState)([]),eS=e=>{er(n=>({...n,[e]:!n[e]}))},eE=e=>n=>{el(s=>({...s,[e]:n.currentTarget}))},eF=e=>()=>{el(n=>({...n,[e]:null}))},eI=()=>{ec("create"),eo(null),ea(!0)},ek=e=>{ec("edit"),eo(e),ea(!0)},eb=async e=>{if(await W({message:"Вы уверены, что хотите удалить это мероприятие?",confirmText:"Удалить",cancelText:"Отмена"}))try{await (0,M.SX)(e.id),el({}),eZ(),V("Мероприятие успешно удалено","success")}catch(e){V("Не удалось удалить мероприятие","error")}};(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,R.g)();K(e.data)}catch(e){V("Не удалось загрузить комнаты","error")}})()},[]);let eZ=async()=>{try{Y(!0),en(null);let e=await (0,M.y$)({roomId:""===ej?void 0:ej,name:eh||void 0,descOrder:eA});X(e),Q(e.length),eC(Math.ceil(e.length/10)),ev(1),ey(e.slice(0,10))}catch(e){V("Не удалось загрузить мероприятия","error")}finally{Y(!1)}};return((0,l.useEffect)(()=>{eZ()},[eh,ej,eA]),q)?(0,i.jsx)(d.A,{theme:k.A,children:(0,i.jsx)(c.A,{sx:{padding:1},children:(0,i.jsx)(x.A,{children:"Загрузка..."})})}):z&&L("ROLE_MODERATOR")?(0,i.jsx)(d.A,{theme:k.A,children:(0,i.jsxs)("div",{children:[(0,i.jsxs)(c.A,{sx:{display:"flex",alignItems:D?"stetch":"center",justifyContent:"space-between",marginBottom:"1em",flexDirection:D?"column":"row",gap:1},children:[(0,i.jsx)(c.A,{sx:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:$?"flex-end":"center",flexDirection:$?"column":"row",gap:1},children:(0,i.jsxs)(c.A,{sx:{display:"flex",gap:1},children:[(0,i.jsx)(x.A,{variant:"h5",sx:{whiteSpace:"nowrap",padding:"12px 0"},children:"Все мероприятия"}),(0,i.jsx)(x.A,{sx:{color:"#A3A3A3"},children:U?0:ee?0:P})]})}),(0,i.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:2,flexDirection:$?"column":"row"},children:[(0,i.jsx)(o.A,{variant:"outlined",color:"secondary",onClick:()=>eI(),sx:{width:$?"100%":"auto"},children:(0,i.jsx)("svg",{height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#858585",children:(0,i.jsx)("path",{d:"M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z"})})}),(0,i.jsxs)(c.A,{sx:{display:"flex",gap:2,width:"100%",flexDirection:$?"column":"row"},children:[(0,i.jsx)(h.A,{variant:"outlined",placeholder:"Название мероприятия",value:eh,onChange:e=>ep(e.target.value),sx:{width:D?"100%":"230px"}}),!e&&(0,i.jsxs)(p.A,{value:ej,onChange:e=>eu(e.target.value),displayEmpty:!0,sx:{width:D?"100%":"230px"},children:[(0,i.jsx)(j.A,{value:"",children:"Все комнаты"}),J.map(e=>(0,i.jsx)(j.A,{value:e.id,children:e.name},e.id))]})]})]})]}),(0,i.jsx)(u.A,{component:A.A,children:(0,i.jsxs)(m.A,{children:[(0,i.jsx)(g.A,{color:"secondary",children:(0,i.jsxs)(v.A,{children:[(0,i.jsx)(w.A,{}),(0,i.jsx)(w.A,{children:"Наименование"}),s&&(0,i.jsx)(w.A,{children:"Автор"}),(0,i.jsx)(w.A,{sx:{whiteSpace:"nowrap"},children:D?"Перег. комната":"Переговорная комната"}),(0,i.jsx)(w.A,{children:(0,i.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>em(!eA),children:[(0,i.jsx)(x.A,{variant:"inherit",children:"Дата"}),(0,i.jsx)(C.A,{size:"small",sx:{ml:.5},children:eA?(0,i.jsx)(F.A,{fontSize:"small"}):(0,i.jsx)(I.A,{fontSize:"small"})})]})}),(0,i.jsx)(w.A,{children:D?"Начало":"Время начала"}),(0,i.jsx)(w.A,{children:D?"Конец":"Время оканчания"}),(0,i.jsx)(w.A,{children:"Повторы"}),(0,i.jsx)(w.A,{align:"center",children:(0,i.jsx)("svg",{width:"16",height:"10",viewBox:"0 0 16 4",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M2 4C1.45 4 0.979167 3.80417 0.5875 3.4125C0.195833 3.02083 0 2.55 0 2C0 1.45 0.195833 0.979167 0.5875 0.5875C0.979167 0.195833 1.45 0 2 0C2.55 0 3.02083 0.195833 3.4125 0.5875C3.80417 0.979167 4 1.45 4 2C4 2.55 3.80417 3.02083 3.4125 3.4125C3.02083 3.80417 2.55 4 2 4ZM8 4C7.45 4 6.97917 3.80417 6.5875 3.4125C6.19583 3.02083 6 2.55 6 2C6 1.45 6.19583 0.979167 6.5875 0.5875C6.97917 0.195833 7.45 0 8 0C8.55 0 9.02083 0.195833 9.4125 0.5875C9.80417 0.979167 10 1.45 10 2C10 2.55 9.80417 3.02083 9.4125 3.4125C9.02083 3.80417 8.55 4 8 4ZM14 4C13.45 4 12.9792 3.80417 12.5875 3.4125C12.1958 3.02083 12 2.55 12 2C12 1.45 12.1958 0.979167 12.5875 0.5875C12.9792 0.195833 13.45 0 14 0C14.55 0 15.0208 0.195833 15.4125 0.5875C15.8042 0.979167 16 1.45 16 2C16 2.55 15.8042 3.02083 15.4125 3.4125C15.0208 3.80417 14.55 4 14 4Z",fill:"#858585"})})})]})}),(0,i.jsx)(f.A,{children:U?(0,i.jsx)(v.A,{children:(0,i.jsx)(w.A,{colSpan:8,children:(0,i.jsx)(x.A,{align:"center",children:"Загрузка..."})})}):ee?(0,i.jsx)(v.A,{children:(0,i.jsx)(w.A,{colSpan:8,children:(0,i.jsx)(x.A,{align:"center",color:"error",children:ee})})}):ef.map((e,n)=>(0,i.jsxs)(t().Fragment,{children:[(0,i.jsxs)(v.A,{sx:{"&:nth-of-type(odd)":{backgroundColor:"#FFFFFF"},"&:nth-of-type(4n-3)":{backgroundColor:"#F4F4F4"}},children:[(0,i.jsx)(w.A,{children:(0,i.jsx)(C.A,{onClick:()=>eS(n),size:"small",sx:{padding:"0"},children:es[n]?(0,i.jsx)(I.A,{}):(0,i.jsx)(F.A,{})})}),(0,i.jsx)(w.A,{sx:{maxWidth:H?"165px":"300px",overflow:es[n]?"visible":"hidden",textOverflow:es[n]?"unset":"ellipsis",whiteSpace:es[n]?"normal":"nowrap"},children:e.name}),s&&(0,i.jsx)(w.A,{children:e.author.fullName}),(0,i.jsx)(w.A,{sx:{maxWidth:"165px",overflow:es[n]?"visible":"hidden",textOverflow:es[n]?"unset":"ellipsis",whiteSpace:es[n]?"normal":"nowrap"},children:e.meetingRoomName}),(0,i.jsx)(w.A,{sx:{whiteSpace:"nowrap"},children:e.date}),(0,i.jsx)(w.A,{children:e.timeStart}),(0,i.jsx)(w.A,{children:e.timeEnd}),(0,i.jsx)(w.A,{sx:{whiteSpace:"nowrap"},children:e.recurrenceInterval?`Каждый (ую) ${e.recurrenceInterval} ${r[e.recurrenceTypeValue]}, до ${e.recurrenceEnd}`:"Нет повторов"}),(0,i.jsxs)(w.A,{align:"center",children:[(0,i.jsx)(C.A,{onClick:eE(n),sx:{padding:"0"},children:(0,i.jsx)("svg",{height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#858585",children:(0,i.jsx)("path",{d:"M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"})})}),(0,i.jsxs)(y.A,{anchorEl:ei[n],open:!!ei[n],onClose:eF(n),sx:{border:"1px solid #858585"},children:[(0,i.jsxs)(j.A,{sx:{gap:1},onClick:()=>ek(e),children:[(0,i.jsx)("svg",{height:"20px",viewBox:"0 -960 960 960",width:"20px",children:(0,i.jsx)("path",{d:"M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"})}),e.recurrenceInterval?"Изменить серию":"Изменить мероприятие"]}),(0,i.jsxs)(j.A,{sx:{gap:1},onClick:()=>eb(e),children:[(0,i.jsx)("svg",{height:"20px",viewBox:"0 -960 960 960",width:"20px",children:(0,i.jsx)("path",{d:"m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"})}),e.recurrenceInterval?"Удалить серию":"Удалить мероприятие"]})]})]})]}),(0,i.jsxs)(v.A,{children:[(0,i.jsx)(w.A,{sx:{padding:0}}),(0,i.jsx)(w.A,{colSpan:7,sx:{padding:0},children:(0,i.jsx)(S.A,{in:es[n],timeout:"auto",unmountOnExit:!0,children:(0,i.jsxs)(c.A,{sx:{margin:2},children:[(0,i.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,i.jsx)(x.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Описание"}),(0,i.jsx)(x.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.description})]}),(0,i.jsxs)(c.A,{sx:{paddingBottom:1},children:[(0,i.jsx)(x.A,{color:"#858585",sx:{backgroundColor:"#E3E3E3",padding:1},children:"Участники"}),e.employees.length>0?e.employees.map(e=>(0,i.jsx)(x.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:e.fullName},e.id)):(0,i.jsx)(x.A,{sx:{backgroundColor:"#F4F4F4",padding:1},children:"Не указано"})]})]})})})]})]},`${e.id}-${e.date}`))})]})}),ew>1&&(0,i.jsx)(c.A,{sx:{mt:4,display:"flex",justifyContent:"start"},children:(0,i.jsx)(E.A,{count:ew,page:eg,onChange:(e,n)=>{ev(n);let s=(n-1)*10;ey(G.slice(s,s+10))},color:"primary",size:"medium"})}),(0,i.jsx)(O.A,{open:et,onClose:()=>{ea(!1),el({}),eo(null),ec("create"),eZ()},mode:ed,event:"create"===ed?null:{name:ex.name,description:ex.description,authorId:ex.author.id,meetingRoomId:ex.meetingRoomId,employeeIds:ex.employees.map(e=>e.id),date:ex.originalDate??ex.date,timeStart:ex.timeStart,timeEnd:ex.timeEnd,recurrenceType:ex.recurrenceTypeValue,recurrenceInterval:ex.recurrenceInterval,recurrenceEnd:ex.recurrenceEnd},idEvent:"create"===ed?null:ex.id}),(0,i.jsx)(_,{})]})}):null};r()}catch(e){r(e)}})}};